<HTML><HEAD>
<TITLE>Custom SQL Request Procedures</TITLE>
</HEAD>

<BODY>

<H2>Custom SQL Request Procedures</H2>

<H4>Introduction</H4>

This document describes the procedures for determining what action to take
on Custom SQL requests which are routed to the coordinator through WTS.
<P>
Custom SQL requests are defined as:
<OL>
<LI>Requests for data which cannot be obtained through the Web or Editorial interfaces.
<LI>Requests for data in specific formats (tab-delimited).
<LI>Requests for data to aid in data clean-up or research.
</OL>

<P>
Custom SQL requests may be requested by:
<OL>
<LI>MGI group members (internal)
<LI>User Support (external)
<LI>Consortium Members (external, may need to track hours)
</OL>
<P>
The flow of an external request (outside WTS):
<OL>
<LI>Request is entered into Remedy by User Support.
<LI>WTS Tracking is created by User Support and routed to "custom SQL" coordinator.
<LI>Coordinator analyzes the WTS record (see Analysis section)
<LI>Coordinator assigns the WTS record for implementation (see Implementation section)
<LI>Implementer reviews the implementation with the coordaintor, installs the report, and notifies
    User Support.  User Support will handle all correspondence with the requester.
</OL>
<P>
The flow of an internal request (from within WTS):
<OL>
<LI>WTS Tracking is created by internal user and routed to "custom SQL" coordinator.
<LI>Coordinator contacts User Support to inform them of the WTS record.
<LI>Coordinator analyzes the WTS record (see Analysis section)
<LI>Coordinator assigns the WTS record for implementation (see Implementation section)
<LI>Implementer reviews the implementation with the coordiantor, installs the report, and handles
    all correspondence with the requester.
</OL>
<P>
All requests must have a WTS tracking record.  The WTS tracking record should be modified with
the appropriate Progress Notes, Status and Time Spent by the coordinator and the implementer as 
needed.
<P>

<H4>Analysis</H4>

<OL>
<LI>Analyze the request to determine the specific user requirements.  The user requirements
    are to be added to the WTS record.  The coordinator may have to contact the person who
    made the request in order to gather this information.  If the request has come through
    User Support (Remedy), then chances are that the user requirements are already well-defined.
    User requirements include:
	<P>
	<OL>
	<LI>A detailed description of the data required.  Which fields are requested, which
	    fields are optional, what constraints are to be placed on the data, etc.
	<P>
	<LI>How the user wishes to access the report:
		<UL>
		<LI>via Web (<CODE>ftp://ftp.informatics.jax.org/pub/informatics/reports</CODE>)
		<LI>via FTP (<CODE>hobbes:/export/ftp/pub/informatics/reports</CODE>)
		<LI>via Email
		<LI>other
		</UL>
	<P>
	<LI>How often the user needs the data generated.  If the user wishes to receive this
	    date more than "one time only", then this report may need to be added to the 
	    <A HREF="MEI/MEIReports.html">MGI Nightly Reports</A> process (notify Lori).
		<UL>
		<LI>one time only
		<LI>daily
		<LI>weekly
		<LI>monthly
		<LI>other
		</UL>
	<P>
	<LI>Contact information of the requester:
		<UL>
		<LI>Name
		<LI>Institution
		<LI>Email Address
		<LI>Phone Number
		</UL>
	<P>
	</OL>
<P>
<LI>The coordinator assigns the implementation of the request to one of the following
    members of the Custom SQL group:
	<UL>
	<LI>Lori Corbani
	<LI>John Gilbert
        <LI>Marge May
	<LI>another SE
	</UL>
<P>
</OL>

<H4>Implementation</H4>
<OL>
<LI>The implementer compares the requirements to any existing custom SQL requests, reports, 
    etc. which may implement requirements which are closely related to the new request.  
    An existing SQL query may already exist which can be used as a template for implementing 
    the new request.
    <P>
    The implementer checks WTS by querying tracking records for Text fields (project definition,
    project notes) which contain key words used in the new user requirements.
    <P>
    The implementer checks the source directories:
    	<UL>
    	<LI><CODE>/mgi/se/customSQL</CODE>
    	<LI><CODE>/home/lec/mgd/sybase/mgi_prod/reports</CODE>
    	</UL>
<P>
<LI>If an existing custom SQL query WTS record already exists which satisfies all of the new user requirements
    and no modifications are needed to the exisiting SQL source to satisfy the new request,
    then there is no need to create a new SQL source file.  The implementer can check the
    existing source out of source code control, annotate the comments section with the new
    WTS number and continue with the Installation procedures.
<P>
<LI>The implementer designs and tests the report.   Include in the comments section of the
    report source:
	<UL>
	<LI>The WTS number of the request.
	<LI>The name of the requester.
	<LI>A <I>brief</I> description of the request, including file format (if applicable).
	<LI>Appropriate comments of the SQL code to assist in future analyzing of the SQL or
	    future modifications to the SQL.
	<LI>The version of the schema that the reports depends upon (ex. MGI 2.2).
	</UL>
<P>
<LI>Refer to <A HREF="MEI/MEIReports.html">MGI Report Requirements</A> 
    for additional standards to be used when composing SQL requests.  Custom SQL requests have 
    the potential to become quality control reports or public reports.  Use the templates for 
    consistency:
	<UL>
	<LI>Python reports:  <CODE>/mgi/se/customSQL/templates/template.py</CODE>
	<LI>SQL reports:  <CODE>/mgi/se/customSQL/templates/template.sql</CODE>
	<LI>README:  <CODE>/mgi/se/customSQL/templates/template.README</CODE>
	</UL>
<P>
<LI>Source/Output Directory:  <CODE>/mgi/se/customSQL</CODE>
    <UL>
    <LI>There is a sub-directory for each main data set (marker, probe, sequence, homology, etc.)
        for which custom SQL reports are created.  These sub-directories correspond with the
	naming conventions used in the 
	<A HREF="http://kelso.informatics.jax.org:4444/software/projects/weborg/system/design.html">Web</A>.
    <LI>Store the SQL source for the request in: <CODE>/mgi/se/customSQL/{sub-directory}</CODE>
    <LI>Store the README for the request in: <CODE>/mgi/se/customSQL/{sub-directory}</CODE>
    <LI>Store a copy of the output of the request in: <CODE>/mgi/se/customSQL/{sub-directory}</CODE>
    </UL>
<P>
<LI>The disclaimer (<CODE>/mgi/se/customSQL/bin/trailer</CODE>) is to be included with the final
    correspondence with the requester.  The disclaimer is usually concatenated onto the end of
    the output, but if this is undesirable then it should be included in the README file.
    See the README template (<CODE>/mgi/se/customSQL/templates/template.README</CODE>).
<P>
</OL>

<H4>Review</H4>
<OL>
<LI>The implementer reviews the SQL and SQL output with the coordinator and/or other members
    of the Custom SQL group.
<P>
<LI>The implementer reviews the SQL output with User Support and/or the requester to verify the 
    data content and format.  Try to maintain consistency and standards whenever possible.
<P>
</OL>

<H4>Installation</H4>
<OL>
<LI>Once the coordinator, the implementer and the requester are satisfied that the request
    has been implemented satisfactorily:
	<OL>
	<LI>The source is added to the SCCS directory: <CODE>/mgi/se/customSQL/{sub-directory}/SCCS</CODE>
	<LI>A final version of the SQL output is generated using the Production database
	    and stored in <CODE>/mgi/se/customSQL/{sub-directory}</CODE>.
	<LI>The SQL output is copied to the appropriate location so the requester
	    can retrieve it (this information is specified in the User Requirements).
	<LI>The requester is notified that the report has been generated and given
	    the location of the report so it can be retrieved.
	</OL>
<P>
<LI>The implementer statuses the WTS record as <I>done</I> and notifies the coordinator
    that this request has been completed.
<P>
</OL>

<H4>WTS Information</H4>
During all phases (Analysis, Implementation, Review, Installation), the coordinator and
the implementer should be statusing the WTS record and adding Progress Notes as needed.
In addition:
<OL>
<LI>The coordinator must include complete contact information of the requester (see Analysis
    section for contact information items).
<LI>The implementer must include the final full path name of the SQL source and output files.
    (ex. <CODE>/mgi/se/customSQL/sequence/MRK_AstraGenBankSwissProt.py</CODE>)
</OL>

</BODY></HTML>
