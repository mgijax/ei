<HTML>
<HEADER>
<TITLE>
MGI: Editorial Utilities
</TITLE>
</HEADER>

<BODY>

<H2>MGI: Editorial Utilities</H2>

<H4>Introduction</H4>

The Editorial Utilities are used to process data for which the algorithms are implemented
in Python.

<H4>Utilities</H4>
<OL>
<LI><A HREF="MEIBreakpointSplit.html">MGI Breakpoint Split</A>
<LI><A HREF="MEIBroadcast.html">MGI Marker Broadcast</A>
<LI><A HREF="MEINLM.html">MGI NLM Update</A>
</OL>

<H4>Development of Utility Programs</H4>
<OL>
<LI>Development source is stored in the directory <CODE>utilities</CODE>.
	<UL>
	<P>
	<LI>After installing the application, the source resides in 
	    <CODE>titan:/usr/local/mgi/ei/mgd</CODE> along with the rest of the application.
	</UL>
<P>
<LI>Naming convention is <I>lowercase + .py</I>.<P>
    <TABLE BORDER=1>
    <TR ALIGN=left><TH>Utility<TH>Program name
    <TR><TD>Breakpoint Split<TD><CODE>breakpointSplit.py</CODE>
    <TR><TD>Marker Broadcast<TD><CODE>broadcast.py</CODE>
    <TR><TD>NLM Update<TD><CODE>nlm.py</CODE>
    </TABLE>
<P>
<LI>All programs must define the following run time parameters:<P>
    <TABLE BORDER=1>
    <TR ALIGN=left><TH>Option<TH>Description<TH>Default
    <TR><TD>-S
	<TD>name of the database server; corresponds to the DSQUERY env variable
	<TD>the user's runtime env DSQUERY variable
    <TR><TD>-D
	<TD>name of the database; corresponds to the MGD env variable
	<TD>the user's runtime env MGD variable
    <TR><TD>-U
	<TD>name of the database user login
	<TD>mgd_public
    <TR><TD>-P
	<TD>name of the file which contains the user's password
	<TD>mgdpub
    <TR><TD>-d
	<TD>sets DEBUG mode
	<TD>DEBUG is off
    </UL>
    </TABLE>
<P>
<LI>All programs must quit and display their correct usage upon incorrect invocation:
    <PRE>
    Error: usage: broadcast.py [-S server] [-D database] -U user -P password file -d input file
    </PRE>
<P>
<LI>All programs must report their status and diagnostics to output files.
    Output files are written to the user's <CODE>$HOME/mgireport</CODE> directory and are also
    archived in an archive directory:<P>
    <TABLE BORDER=1>
    <TR ALIGN=left><TH>Utility<TH>Archive Directory
    <TR><TD>Breakpoint Split<TD><CODE>/usr/local/mgi/ei/mgd/mgireport/SPLITS</CODE>
    <TR><TD>Marker Broadcast<TD><CODE>/usr/local/mgi/ei/mgd/mgireport/BROADCAST</CODE>
    <TR><TD>NLM Update<TD>exception; see requirements document for details
    </TABLE>
<P>
<LI>All programs must report their status (intended for users) to a <I>.stats</I> file:<P>
    <TABLE BORDER=1>
    <TR ALIGN=left><TH>Utility<TH>File Name
    <TR><TD>Breakpoint Split<TD><CODE>breakpointSplit.InX3H.stats</CODE>
    <TR><TD>Marker Broadcast<TD><CODE>Broadcast-1-7-99.stats</CODE>
    <TR><TD>NLM Update<TD>exception; see requirements document for details
    </TABLE>
    <P>
    Status reports include:
    <UL>
    <LI>Header describing what the program has done.
    <LI>Date the status report was created.
    <LI>Information helpful to an end-user.
	<PRE>
	Broadcast Status Report - Wed Jan 06 13:17:50 1999

	WITHDRAWALS
	 
	 Ly49h   G       W       withdrawn, = Klra8      J:23000
		 Broadcast Report Generated
		 New Symbol Klra8 Inserted (38712)
		 Symbol Changed in MLC Edit Tables
		 Symbol Withdrawn
	</PRE>
    </UL>
<P>
<LI>All programs must report their diagnostics (intended for software engineers) to a 
    <I>.diagnostics</I> file:<P>
    <TABLE BORDER=1>
    <TR ALIGN=left><TH>Utility<TH>File Name
    <TR><TD>Breakpoint Split<TD><CODE>breakpointSplit.InX3H.diagnostics</CODE>
    <TR><TD>Marker Broadcast<TD><CODE>Broadcast-1-7-99.diagnostics</CODE>
    <TR><TD>NLM Update<TD>exception; see requirements document for details
    </TABLE>
    <P>
    Diagnostics include:
    <UL>
    <LI>Header describing what the program has done.
    <LI>Date the diagnostic report was created.
    <LI>Server, Database, User, Debug mode and any input file names which would be useful
	for the SE debugging the program to know.
	<PRE>
	Broadcast Diagnostics Report - Wed Jan 06 13:17:50 1999

	Server:  MGD
	Database:  mgd
	User:  djr
	File:  /home/djr/mgireport/Broadcast-1-7-99
	Debug:  0
	</PRE>
    <LI>All SQL generated by the program, particulary the database updates.  SQL logging can
	be turned on within the Python program.  This output is sent to the diagnostic file by
	creating a file descriptor to the diagnostics file and routing the output to that file:
	<PRE>
                # Log all SQL commands
                mgdlib.set_sqlLogFunction(mgdlib.sqlLogAll)
 
                # Open Diagnostics file
                diagFile = open(inputFile + '.diagnostics', 'w')
 
                # Initialize logging file descriptor
                mgdlib.set_sqlLogFD(diagFile)
	</PRE>
    </UL>
<P>
<LI>Some programs may require that only one instance of the program may run at a time.
    If this is a requirement, then the program must create a lock file in its archive directory
    and disallow execution of the program if a lock file exists in the archive directory:<P>
    <TABLE BORDER=1>
    <TR ALIGN=left><TH>Utility<TH>Lock File
    <TR><TD>Breakpoint Split<TD><CODE>/usr/local/mgi/ei/mgd/mgireport/SPLITS/breakpointSplit.lock</CODE>
    <TR><TD>Marker Broadcast<TD><CODE>/usr/local/mgi/ei/mgd/mgireport/BROADCAST/broadcast.lock</CODE>
    <TR><TD>NLM Update<TD>exception; see requirements document for details
    </TABLE>
<P>
<LI>All programs are to be executed from the Editorial Interface via a dialog.  The dialog must:
    <P>
    <UL>
    <LI>Perform data verifications (whenever possible) prior to invoking the program.
    <LI>Provide a <I>Process</I> button which will ask the user whether s/he wishes to continue
	with the process.  If the user responds <I>yes</I>, then the program is invoked.  If
	the user responds <I>no</I>, then the program is not invoked.
    <LI>Provide the user with a <I>Cancel</I> button to cancel continuing with the process.
    <LI>Provide the user with information regarding the name and location of the output files
	which are generated by the program.
    <LI>There are several dialog templates for the current Utilities which can be used as templates
	for future implemenations:<P>
    	<TABLE BORDER=1>
    	<TR ALIGN=left><TH>Utility<TH>Dialog Template
    	<TR><TD>Breakpoint Split<TD>MRKBreakpointSplitDialog
    	<TR><TD>Marker Broadcast<TD>WithdrawalDialog
    	<TR><TD>NLM Update<TD>NLMDialog
    	</TABLE>
    </UL>
</OL>

<HR>

</BODY>
</HTML>
