<HTML>
<HEADER>
<TITLE>
MGI: Nightly Reports
</TITLE>
</HEADER>

<BODY>

<H2>MGI: Nightly Reports</H2>

<H4>Introduction</H4>

The Nightly Reports process is an automated process by which local (private) and public reports
are generated from the MGI databases and installed in their appropriate places for access.

<H4>Reports</H4>
<OL>
<LI>The script is <CODE>titan:/usr/local/mgi/ei/mgd/nightly_reports</CODE>, a shell script which
    executes files with extension <CODE>.sql</CODE> or <CODE>.py</CODE> residing in 
    <CODE>titan:/usr/local/mgi/ei/mgd</CODE>.
<P>
<LI>Report source for all MGI applications (MGD, GXD) resides in <CODE>titan:/usr/local/mgi/ei/mgd</CODE>.
<P>
<LI>This script is executed from the DBA's production load script <CODE>$SYBASE/admin/utilities/load_pub</CODE>
    which is run Monday-Friday via user <CODE>sybase's</CODE> cron on <CODE>titan</CODE>.
<P>
<LI>Local reports are reports which are only available to folks within the 
    <CODE>informatics.jax.org</CODE> domain and:
	<UL>
	<LI>Muriel Davisson
	<LI>Wendy Pelletier
	<LI>Linda Neleski
	</UL>
    <P>
    Local reports can be accessed from:
	<UL>
	<LI><A HREF="http://kelso:4444/qcr.html">Quality Control Reports Page</A>
	<LI><A HREF="http://kelso:4444/~lec/mgireport">Lori's Public mgireport directory</A>
	</UL>
<P>
<LI>Public reports are reports which are available to anyone.  They are available from:
	<UL>
	<LI><A HREF="ftp://ftp.informatics.jax.org/pub/informatics/reports/index.html">Informatics FTP Server</A>
	<LI><CODE>titan:/usr/local/mgi/ei/mgd/mgireport</CODE>
	<LI><CODE>hobbes:/export/ftp/pub/informatics/reports</CODE>
	</UL>
   <P>
   These include tab-delimited data dumps which are used by other software folks to download
   data from the MGI databases for use at their sites.
</OL>

<H4>Development of Reports</H4>
<OL>
<LI>Development report source is stored in the directory <CODE>/home/lec/mgd/sybase/mgi_dev/reports</CODE>.
	<UL>
	<P>
	<LI>New reports must be added to <CODE>/home/lec/mgd/sybase/mgi_dev/utilities/nightly_reports</CODE>,
	    the shell script which generates the reports.  Public reports are added to the list
	    of <CODE>PUBLIC_RPTS</CODE> defined in the shell script.  Internal reports are added 
	    to the list of <CODE>INTERNAL_RPTS</CODE> defined in the shell script.  If a new report
	    is not defined in the shell script, it will not be generated during the nightly
	    report process.
	<P>
	<LI>New reports must be added to the <CODE>INSTALLFILE</CODE> list defined in the
	    application configuration file <CODE>/home/lec/mgd/sybase/mgi_dev/mgd/uxb.conf</CODE>.
	    During the installation of the application, all files defined in the 
	    <CODE>INSTALLFILE</CODE> list are copied to the installation directory of the
	    application.
	<P>
	<LI>After installing the application, the report source resides in 
	    <CODE>titan:/usr/local/mgi/ei/mgd</CODE> along with the rest of the MGD application.
	<P>
	<LI>Internal reports are added to the <CODE>http://kelso:4444/qcr.html</CODE>, Quality
	    Control Reports page in the appropriate section.
	</UL>
<P>
<LI>There are two types of reports, SQL (<CODE>.sql</CODE>) and Python (<CODE>.py</CODE>).
    <P>
    Use SQL reports for all reports which do not require any special formatting.  Most reports
    fall into this category.  Use the template <CODE>template.sql</CODE> when creating a new
    SQL report.
    <P>
    Use Python reports for all reports which require special formatting, such as tab-delimited
    data dumps.  Use the template <CODE>template.py</CODE> when creating a new Python report.
<P>
<LI>Report naming convention is to use the standard table prefix (BIB, HMD, MRK, PRB, GXD, etc.)
    which relates to the primary data the report is generating, an underscore, a string which
    describes some aspect of the data the report is generating and a suffix (.sql or .py) depending
    on which type of report it is:
	<PRE>
		prefix + _ + description + suffix
	</PRE>
    <P>
    For example, <CODE>BIB_NeedNLM.sql</CODE> is an SQL report which lists all References (BIB)
    which require NLM updates.
<P>
<LI>Use lowercase for all SQL reserved words/commands 
    (i.e. <CODE>select</CODE>, not <CODE>SELECT</CODE>)
<P>
<LI>All SQL reports require a header.  The template <CODE>template.sql</CODE> calls
    <CODE>header.sh</CODE>, which formats the header:
    <PRE>
    The Jackson Laboratory - Mouse Genome Informatics - Mouse Genome Database (MGD)
    Copyright 1996 The Jackson Laboratory
    All Rights Reserved
    Date Generated:  Fri Jan  1 23:57:18 EST 1999
    (SERVER=MGD;DATABASE=mgd)
    </PRE>
<P>
<LI>All public SQL reports also require a footer.  The template <CODE>template.sql</CODE> 
    concatenates the trailer text from <CODE>trailer</CODE> onto the end of the SQL output file.
    <P>
    The footer reads as:
    <PRE>
	WARRANTY DISCLAIMER AND COPYRIGHT NOTICE
	THE JACKSON LABORATORY MAKES NO REPRESENTATION ABOUT THE SUITABILITY OR
	ACCURACY OF THIS SOFTWARE OR DATA FOR ANY PURPOSE, AND MAKES NO WARRANTIES,
	EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES OF MERCHANTABILITY AND 
	FITNESS FOR A PARTICULAR PURPOSE OR THAT THE USE OF THIS SOFTWARE OR DATA
	WILL NOT INFRINGE ANY THIRD PARTY PATENTS, COPYRIGHTS, TRADEMARKS OF OTHER
	RIGHTS.  IT IS PROVIDED "AS IS."

	This software and data is provided as a service to the scientific community
	to be used only for research and educational purposes.  Any commercial
	reproduction is prohibited without the prior written permission of The
	Jackson Laboratory.

	Copyright 1996 The Jackson Laboratory
	All Rights Reserved
    </PRE>
<P>
<LI>All Python reports require a header and a footer.  The Python library routines 
    <CODE>reportlib.init()</CODE> and <CODE>reportlib.trailer()</CODE> print out the header
    and footer comments, respectively.
    <P>
</OL>

<HR>

</BODY>
</HTML>
