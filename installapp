#!/bin/csh -f

#
# Builds (if necessary) and installs a compiled/interpreted version of 
# application using uxb.conf.
#
# Usage:
#
#	installapp applicationdirectory [compiled]
#
# if 'compiled' is given as an argument, then the application is installed 
# as a compiled application, rather than an interpreted D app.
#

source ./Configuration

setenv EIAPP	$1
setenv MODE	$2

# create the application directory if it isn't already there

if ( ! -d ${EIINSTALLDIR}/${EIAPP} ) then
	mkdir -p ${EIINSTALLDIR}/${EIAPP}
endif

setenv LOG	${EIINSTALLDIR}/install${EIAPP}.log
rm -rf ${LOG}

date > ${LOG}

switch ("${MODE}")
	case compiled:	
			setenv OPTIONS "-dmode compiled"
			breaksw
	default:	
			setenv OPTIONS ""
			breaksw
endsw

#
# uxb.conf is assumed...
#

cd ${EIAPP}
uxb ${OPTIONS} -destdir ${EIINSTALLDIR}/${EIAPP} install >>& ${LOG}
cd ..

#
# Copy main files to installation directory
#

if ( ! -f ${EIINSTALLDIR}/Configuration ) then
	cp Configuration ${EIINSTALLDIR}
endif

if ( ! -f ${EIINSTALLDIR}/runapp ) then
	cp runapp ${EIINSTALLDIR}
endif

date >> ${LOG}

